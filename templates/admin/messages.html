{% extends "admin/base.html" %}

{% block title %}Contact Messages - Admin{% endblock %}

{% block content %}
<div class="admin-header">
    <h1><i class="fas fa-envelope"></i> Contact Messages</h1>
    <p>View and manage messages from your contact form</p>
</div>

<div class="admin-content">
    {% if messages %}
    <div class="data-table">
        <table>
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Name</th>
                    <th>Email</th>
                    <th>Subject</th>
                    <th>Message</th>
                    <th>Status</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for message in messages %}
                <tr class="message-row {% if not message.is_read %}unread{% endif %}">
                    <td>{{ message.created_at.strftime('%Y-%m-%d %H:%M') }}</td>
                    <td>
                        <strong>{{ message.name }}</strong>
                    </td>
                    <td>
                        <a href="mailto:{{ message.email }}">{{ message.email }}</a>
                    </td>
                    <td>{{ message.subject }}</td>
                    <td>
                        <div class="message-preview">{{ message.message }}</div>
                    </td>
                    <td>
                        {% if message.is_read %}
                        <span class="badge badge-success">Read</span>
                        {% else %}
                        <span class="badge badge-warning">Unread</span>
                        {% endif %}
                    </td>
                    <td class="actions">
                        {% if not message.is_read %}
                        <a href="{{ url_for('admin_mark_message_read', id=message.id) }}" 
                           class="btn btn-sm btn-secondary" title="Mark as read">
                            <i class="fas fa-check"></i>
                        </a>
                        {% endif %}
                        <a href="{{ url_for('admin_delete_message', id=message.id) }}" 
                           class="btn btn-sm btn-danger" 
                           onclick="return confirm('Are you sure you want to delete this message?')"
                           title="Delete message">
                            <i class="fas fa-trash"></i>
                        </a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <div class="empty-state">
        <i class="fas fa-envelope"></i>
        <h3>No Messages</h3>
        <p>You haven't received any contact messages yet.</p>
    </div>
    {% endif %}
</div>

<style>
.message-row.unread {
    background: rgba(59, 130, 246, 0.05);
    font-weight: 500;
}

.message-preview {
    max-width: 300px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.badge {
    display: inline-flex;
    align-items: center;
    padding: 0.25rem 0.5rem;
    border-radius: 0.375rem;
    font-size: 0.75rem;
    font-weight: 500;
}

.badge-success {
    background: rgba(16, 185, 129, 0.1);
    color: #059669;
}

.badge-warning {
    background: rgba(245, 158, 11, 0.1);
    color: #d97706;
}
</style>
{% endblock %}